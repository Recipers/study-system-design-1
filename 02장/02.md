# 2. 개략적인 규모 추정

시스템을 디자인할 때, 보유한 자원이 설계의 요구사항에 부합하는지 계산하는 능력이 필요하다.

이 장에서는 계산에 필요한 다양한 기준을 개략적으로 보여준다.

## 2의 제곱수
필요한 2의 제곱수는 암기하도록 하자.

## 모든 프로그램가 알아야 하는 응답지연 값

캐시 참조부터 패킷의 왕복 시간까지 다양한 연산 시간을 수치로 나타내고 있다. 

해당 자료는 다음과 같은 결론을 나타낸다.

- 메모리는 빠르지만, 디스크는 아직 느리다.

- 디스크 탐색은 가능한 피해라.
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷으로 전송하기 전에 가능하면 압축해라.
- 데이터 센터 간에 데이터를 주고 받는 데 시간이 걸린다.

## 가용성에 관계된 수치들

가용률을 보통 99~100 사이의 값으로 나타낸다. 높을수록 안정적인 서비스다.

## 트위터 QPS와 저장소 요구량 추정

다음은 설계 요구사항 충족에 필요한 자원을 계산하는 과정을 나타낸다. QPS는 초당 쿼리량을 의미한다.

### 가정

- MAU가 3억명이다.

- 50%의 사용자가 트위터를 매일 이용한다.
- 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10%다.
- 데이터는 5년간 보존된다.

### QPS 추정치

- DAU는 3억명 * 50% = 1.5억명

- QPS = 1.5억 * 2트윗 / 24시간 / 3600초 = 3500
- 최대 QPS = 3500 * 2 = 7000

### 미디어 저장을 위한 저장소 요구량

- 평균 트윗 크기 : id에 64바이트, 텍스트에 140바이트, 미디어에 1MB

- 미디어 저장소 요구량 = 1.5억 * 2건 * 10% * 1MB = 30TB/일
- 5년간 미디어를 보관하기 위한 저장소 요구량 = 55PB

## 팁

개략적인 규모 추정과 관계된 면접에서 가장 중요한 것은 문제를 풀어나가는 절차다.

올바른 절차를 밟느냐가 결과를 내는 것보다 중요하다.

면접자는 문제 해결 능력을 보고싶어 한다. 이를 지키기 위해선 다음을 숙지해야 한다.

- 문제 해결 능력 검증 과정에서 정확한 계산은 낭비다. 근사치로 계산하자.

- 가정을 적어두자.
- 단위를 붙이자. 나중에 헷갈린다.
- QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 문제가 많이 나온다. 미리 연습하자.